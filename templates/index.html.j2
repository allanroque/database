<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <title>PG Health — {{ report.host }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css?v=1" />
  <script defer src="script.js"></script>
</head>
<body>
  <header>
    <h1>PG Health</h1>
    <ul class="nav-links">
      <li><a href="#so">SO</a></li>
      <li><a href="#pg">PostgreSQL</a></li>
      <li><a href="#sizes">Tamanho por DB</a></li>
      <li><a href="#logs">Logs</a></li>
    </ul>
  </header>

  <section class="hero-section">
    <h2>{{ report.host }}</h2>
    <p>Coletado em {{ report.collected_at }}</p>
  </section>

  <div class="container">
    <main>
      <div id="so" class="card">
        <h3>SO</h3>
        <p><b>Distro:</b> {{ report.os.distro }}</p>
        <p><b>Kernel:</b> {{ report.os.kernel }}</p>
        <p><b>Arch:</b> {{ report.os.arch }}</p>
        <p><b>Uptime:</b> {{ report.os.uptime }}</p>
        <p><b>Memória:</b> {{ report.os.mem_mb }} MB &nbsp; <b>vCPUs:</b> {{ report.os.cpu_vcpus }}</p>
        <p><b>Mounts:</b> {{ report.os.mounts|join(', ') }}</p>
      </div>

      <div id="pg" class="card">
        <h3>PostgreSQL (básico)</h3>
        <pre>{{ report.postgres.basics }}</pre>
      </div>

      <div id="sizes" class="card">
        <h3>Tamanho por DB</h3>
        <pre>{{ report.postgres.db_sizes }}</pre>
      </div>

      <div id="logs" class="card">
        <h3>Erros recentes (log)</h3>
        <pre>{{ report.postgres.recent_errors or 'Sem erros recentes.' }}</pre>
      </div>

      <div class="card">
        <h3>JSON cru</h3>
        <p>Disponível em <code>/pg-health/health.json</code></p>
        <pre>{{ report | to_nice_json }}</pre>
      </div>
    </main>

    <aside>
      <h3>Atalhos</h3>
      <ul id="playlist">
        <li onclick="location.href='#so'">Sistema Operacional</li>
        <li onclick="location.href='#pg'">Parâmetros PG</li>
        <li onclick="location.href='#sizes'">Tamanhos</li>
        <li onclick="location.href='#logs'">Logs</li>
      </ul>

      <div class="ad-block">
        <p><b>Status rápido</b></p>
        <p><span class="pill ok"></span> serviço ativo</p>
        <p><span class="pill warn"></span> verifique autenticação</p>
      </div>
    </aside>
  </div>

  <footer>
    <p>PG Health Lab • gerado por Ansible</p>
  </footer>
</body>
</html>

